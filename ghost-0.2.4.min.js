/*!
 * https://www.ghostplugin.com/
 * ghost.min.js v0.2.4
 * Copyright 2020 Demonicsoft Inc.
 * Released under the MIT License.
 */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("GhostPlugin requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(S,e){"use strict";var M=function(){var e,t,n,i="unknown",o="-1",r=S.navigator.userAgent;try{-1<r.indexOf("GhostEmulator")?(i="Emulator",o=r.match(/GhostEmulator\/([\d.]+)/)[1]):-1<r.indexOf("MetaSr")?(i="MetaSr",o=(-1<r.indexOf("Chrome")?"Chrome:":"IE:")+r.match(/MetaSr\ ([\d.]+)/)[1]):-1<r.indexOf("QQBrowser")?(i="QQ",o=(-1<r.indexOf("Chrome")?"Chrome:":"IE:")+r.match(/QQBrowser\/([\d.]+)/)[1]):/MSIE 10.0/.test(r)?(i="IE",o="10"):/rv:([\d.]+)\) like gecko/.test(r.toLowerCase())?(i="IE",o="11"):-1<r.indexOf("Edg")?(i="Edg",o=r.match(/Edg\/([\d.]+)/)[1]):-1<r.indexOf("Opera")||-1<r.indexOf("OPR")?(i="Opera",o=-1<r.indexOf("Opera")?r.match(/Opera.([\d.]+)/)[1]:r.match(/OPR\/([\d.]+)/)[1]):-1<r.indexOf("Chrome")&&-1<r.indexOf("Safari")?(i="Chrome",o=r.match(/Chrome\/([\d.]+)/)[1]):-1<r.indexOf("Firefox")&&(i="Firefox",o=r.match(/Firefox\/([\d.]+)/)[1]),o&&(o=0<(n=(e=o).indexOf("."))&&-1!==(t=e.indexOf(".",n+1))?e.substr(0,t):e)}catch(e){i="unknown",o="-1"}return{type:i,version:o}}();if("unknown"===M.type)throw new Error("GhostPlugin do not Support current browser.");var n="0123456789abcdef";function s(){for(var e=[],t=0;t<36;t++)e[t]=8===t||13===t||18===t||23===t?"-":n[Math.floor(16*Math.random())];return e.join("")}var i="0.2.4",o="4u.ghostplugin.com",r=[],T=!0,c=s(),a=function(){};function d(e,t,n,i){var o={command:"register",id:s(),senderId:c,content:{extensionKey:t.extensionKey,extensionVersion:t.extensionVersion,extensionToken:t.extensionToken,browserTitle:document.title,browserType:M.type,browserVersion:M.version,viewEntity:i.viewEntity,extensionConfig:n,host:S.location.origin}},r=e.send(JSON.stringify(o));w.isEmulated&&r.then(function(e){var t=JSON.parse(e);i.token=t.token,i.wws=f(t.port,t.token,i)})}function f(e,t,r){var n=new WebSocket("wss://"+o+":"+e+"/angel?token="+t);return n.onopen=function(){S.setTimeout(function(){r.isReady=!0,r._ready&&r._ready(r)},100)},n.onmessage=function(e){var t=e.data,n=JSON.parse(t);switch(n.command){case"invoke_rsp":r.invokeList&&r.invokeList[n.id]&&(r.invokeList[n.id](n.content),delete r.invokeList[n.id]);break;case"invoke":var i=null,o=!1;if(r.client[n.content.command])try{i=r.client[n.content.command].apply(r,n.content.args),o=!0}catch(e){i=e.message}else i="can't find method \""+n.content.command+'", pay attention to case sensitivity';r.wws.send(JSON.stringify({command:"invoke_rsp",id:n.id,senderId:c,content:{isSuccess:o,result:i}}));break;case"info":m(r,n.content.code,n.content.info);break;case"error":l(r,n.content.code,n.content.info);break;case"warn":v(r,n.content.code,n.content.info)}},n.onclose=function(){r.isReady=!1,r._close&&r._close(r)},n}function h(e,t){if(t)for(var n in t||{})e[n]=t[n]}var u=" for more information please visit https://www.ghostplugin.com/docs/latest/get-started/msgcode#";function l(e,t,n){e._error!==a?e._error(t,n):console.error("[GP]["+t+"] "+n+u+t)}function m(e,t,n){e._info!==a?e._info(t,n):console.info("[GP]["+t+"] "+n+u+t)}function v(e,t,n){e._warn!==a?e._warn(t,n):console.warn("[GP]["+t+"] "+n+u+t)}function w(){this.host={},this.client={},this._ready=this._close=this._info=this._warn=this._error=a,r.push(this)}function t(e){for(var t=0;t<r.length;t++){var n=r[t];n.isReady&&n.updateView(e)}}w.isEmulated="Emulator"===M.type,w.prototype={load:function(e,t,n){var r,s=this;return s.isReady=null,n&&(s.viewConfig=n,s.viewEntity={isActive:!0,isVisible:!0},h(s.viewEntity,p(n))),w.isEmulated?CefSharp.BindObjectAsync("emulator").then(function(){d(emulator,e,t,s)}):((r=new WebSocket("wss://"+o+":34543/angel?v="+i)).onopen=function(){d(r,e,t,s)},r.onmessage=function(e){var t=JSON.parse(e.data),n=t.content;switch(t.command){case"register_rsp":var i=n.port,o=n.token;s.token=o,s.wws=f(i,o,s),r.close();break;case"info":m(s,n.code,n.info);break;case"warn":v(s,n.code,n.info);break;case"error":l(s,n.code,n.info)}},r.onclose=function(e){(w.isAvailable=1005===e.code)||l(s,20001,"host unavailable")}),this},onConnected:function(e){return this._ready=e,this},onInfo:function(e){return this._info=e,this},onError:function(e){return this._error=e,this},onWarn:function(e){return this._warn=e,this},onDisconnect:function(e){return this._close=e,this},invoke:function(e,t,n){this.invokeList||(this.invokeList={});var i={command:"invoke",id:s(),senderId:c,content:{command:e,args:t}};this.invokeList[i.id]=n,this.wws.send(JSON.stringify(i))},updateView:function(e){return this.viewEntity&&(h(this.viewConfig,e),h(this.viewEntity,p(this.viewConfig)),this.wws.send(JSON.stringify({command:"updateView",id:s(),senderId:c,content:this.viewEntity}))),this},show:function(){return this.updateView({isVisible:!0}),this},hide:function(){return this.updateView({isVisible:!1}),this},unload:function(){this.wss&&this.wss.close()},getState:function(){return void 0===this.isReady?"created":null===this.isReady?"connecting":!0===this.isReady?"connected":!1===this.isReady?"disconnect":"unknown"},makeHostProxy:function(){this.host={};for(var e=0;e<arguments.length;e++)this.host[arguments[e]]=function(i,o){return function(){var e,t=null,n=Array.prototype.slice.call(arguments);0<arguments.length&&("function"==typeof(e=n[n.length-1])&&(t=e,--n.length)),i.invoke(o,n,t)}}(this,arguments[e])}};var W=0,C=document.documentElement;function p(e){return"Firefox"===M.type?(m=(l=e).width,v=l.height,w=l.marginLeft,p=l.marginTop,g=l.isVisible,y=w-C.scrollLeft,k=p-C.scrollTop,b=Math.min(y-(l.offsetLeft||0),0),E=Math.min(k-(l.offsetTop||0),0),x=Math.max(y,l.offsetLeft||0),O=Math.max(k,l.offsetTop||0),L=function(){var e=S.outerWidth-S.innerWidth;return A()?e:R()?e-16:e-11}(),_=function(){var e=S.outerHeight-S.innerHeight;return A()?e:R()?e-15:e-7}(),{viewportWidth:Math.min(m+b,S.innerWidth-(l.offsetRight||0)-(H()?W:0)-x),viewportHeight:Math.min(v+E,S.innerHeight-(l.offsetBottom||0)-(V()?W:0)-O),viewportLeft:x+L,viewportTop:O+_,contentWidth:m,contentHeight:v,contentLeft:b,contentTop:E,isActive:!!T,isVisible:g}):(n=(t=e).width,i=t.height,o=t.marginLeft,r=t.marginTop,s=t.isVisible,c=o-C.scrollLeft,a=r-C.scrollTop,d=Math.min(c-(t.offsetLeft||0),0),f=Math.min(a-(t.offsetTop||0),0),h=Math.max(c,t.offsetLeft||0),u=Math.max(a,t.offsetTop||0),{viewportWidth:Math.min(n+d,S.innerWidth-(t.offsetRight||0)-(H()?W:0)-h),viewportHeight:Math.min(i+f,S.innerHeight-(t.offsetBottom||0)-(V()?W:0)-u),viewportLeft:h,viewportTop:u,contentWidth:n,contentHeight:i,contentLeft:d,contentTop:f,isActive:!!T,isVisible:s});var t,n,i,o,r,s,c,a,d,f,h,u,l,m,v,w,p,g,y,k,b,E,x,O,L,_}function V(){return document.body&&document.body.scrollWidth>document.body.clientWidth}function H(){return document.body&&document.body.scrollHeight>S.innerHeight-(V()?W:0)}function R(){return 2*(S.screen.availLeft-S.screenX)==S.outerWidth-S.screen.availWidth&&2*(S.screen.availTop-S.screenY)==S.outerHeight-S.screen.availHeight}function A(){return S.screenX===S.screen.availLeft&&S.screenY===S.screen.availTop&&S.outerHeight===S.screen.height&&S.outerWidth===S.screen.width}return S.addEventListener("focus",function(){t({isActive:T=!0})}),S.addEventListener("blur",function(){t({isActive:T=!1})}),S.addEventListener("resize",function(){t()}),S.addEventListener("scroll",function(){t()}),document.addEventListener("DOMContentLoaded",function(){W=function(){var e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=document.createElement("div");e.appendChild(t);var n=e.offsetWidth-t.offsetWidth;return e.parentNode.removeChild(e),n}()}),(w.check=function(t){var e;w.isEmulated?t&&t(!0):((e=new WebSocket("wss://"+o+":34543/angel?c="+i)).onopen=function(){e.close()},e.onclose=function(e){t&&t(1005===e.code)})})(function(e){w.isAvailable=e}),w.version=i,void 0===e&&(S.GhostPlugin=w),w});